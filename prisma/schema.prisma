// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

// Model untuk Karyawan (Employee)
model Karyawan {
  id             String          @id @default(uuid())
  nip            String          @unique
  nama           String
  jabatan        String
  departemen     String
  nilaiKinerja   Float           
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
  
  // Relasi ke penilaian detail
  penilaianDetail PenilaianDetail[]

  @@map("karyawan")
}

// Model untuk Kriteria Penilaian
model Kriteria {
  id             String          @id @default(uuid())
  kode           String          @unique // KRT1, KRT2, dst
  namaKriteria   String          // Sikap, Kecerdasan, Kepribadian
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
  
  // Relasi ke sub kriteria
  subKriteria    SubKriteria[]

  @@map("kriteria")
}

// Model untuk Sub Kriteria
model SubKriteria {
  id             String          @id @default(uuid())
  kode           String          @unique // KRT1, KRT2, dst (sama dengan kode di tabel)
  kriteriaId     String
  namaSubKriteria String         // Tanggung jawab, Disiplin, Jujur, dst
  faktor         String          // core factor, secondary factor
  nilaiStandar   Int             // Nilai standar (biasanya 3)
  createdAt      DateTime        @default(now())
  updatedAt      DateTime        @updatedAt
  
  // Relasi
  kriteria       Kriteria        @relation(fields: [kriteriaId], references: [id], onDelete: Cascade)
  penilaianDetail PenilaianDetail[]

  @@map("sub_kriteria")
}

// Model untuk Penilaian Detail Karyawan per Sub Kriteria
model PenilaianDetail {
  id             String       @id @default(uuid())
  karyawanId     String
  subKriteriaId  String
  nilai          Int          // Nilai yang diberikan untuk sub kriteria ini
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt
  
  // Relasi
  karyawan       Karyawan     @relation(fields: [karyawanId], references: [id], onDelete: Cascade)
  subKriteria    SubKriteria  @relation(fields: [subKriteriaId], references: [id], onDelete: Cascade)

  @@unique([karyawanId, subKriteriaId])
  @@map("penilaian_detail")
}

